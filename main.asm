.MODEL small
.STACK 100H
.DATA 
MSG1 DB "TIC TAC TOE$"
MSG2 DB "START$"
CHECK DB 10 DUP(0)  
PLAYER_1 DB "PLAYER_X WINS!!!$" 
PLAYER_2 DB "PLAYER_O WINS!!!$"  
DRAW DB "DRAW!!!  :($"
PLAY_AGAIN DB "PLAY AGAIN?$"
YES DB "YES$"
NO DB "NO$"
VALUE DB 0

.CODE
MAIN PROC
  MOV  AX,@DATA
  MOV DS,AX
  MOV ES,AX
  ;SELECT DISPLAY MODE
  MOV AH,0
  MOV AL,04H
  INT 10H
  
  
  MOV VALUE,0
  MOV CHECK,0
  MOV CHECK+1,0
  MOV CHECK+2,0
  MOV CHECK+3,0
  MOV CHECK+4,0
  MOV CHECK+5,0
  MOV CHECK+6,0
  MOV CHECK+7,0
  MOV CHECK+8,0
  
 
  ;SELECT BACKGROUND COLOR
  MOV AH,0BH
  MOV BH,00H
  MOV BL,0
  INT 10H 
  ;WRITE TIC TAC TOE ON SCREEN
  MOV AH,13H ;SERVICE TO DISPLAY STRING WITH COLOR.
  mov  bp,offset msg1 ;STRING TO DISPLAY.
  MOV BH,0;PAGE
  MOV BL,2
  MOV CX,11 ;STRING LENGTH.
  MOV DL,2 ;X (SCREEN COORDINATE). 
  MOV DH,4 ;Y (SCREEN COORDINATE). 
  INT 10H ;BIOS SCREEN SERVICES. 
  ;write start
  mov bp,offset msg2
  MOV CX,5
  MOV DL,4
  MOV DH,8
  MOV BL,5
  INT 10H
  MOV AH,0CH
  MOV AL,2
  MOV CX,150
  MOV DX,0
  PD:
  INT 10H
  INC DX
  CMP DX,200
  JLE PD
  
  MOV AH,0CH
  MOV AL,3
  MOV CX,160
  MOV DX,0
  MD:
  INT 10H
  INC DX
  CMP DX,200
  JLE MD
  
  MOV AH,0CH
  MOV AL,2
  MOV CX,170
  MOV DX,0
  KD:
  INT 10H
  INC DX
  CMP DX,200
  JLE KD
  
  MOV AH,0CH
  MOV AL,5
  MOV CX,180
  MOV DX,0
  LD:
  INT 10H
  INC DX
  CMP DX,200
  JLE LD
  
  MOV AH,0CH
  MOV AL,3
  MOV CX,190
  MOV DX,0
  OP:
  INT 10H
  INC DX
  CMP DX,200
  JLE OP
  
  MOV AH,0CH
  MOV AL,2
  MOV CX,200
  MOV DX,0
  OL:
  INT 10H
  INC DX
  CMP DX,200
  JLE OL
  
  MOV AH,0CH
  MOV AL,3
  MOV CX,210
  MOV DX,0
  OM:
  INT 10H
  INC DX
  CMP DX,200
  JLE OM
  
  MOV AH,0CH
  MOV AL,1
  MOV CX,220
  MOV DX,0
  OK:
  INT 10H
  INC DX
  CMP DX,200
  JLE OK
  

  ;SELECT ANOTHER PAGE WHEN MOUSE CLICKED
  MOV AX,1
  INT 33H
 
  MOUSELOOP:
  MOV AX,5
  INT 33H
  CMP AX,1B
  JNE MOUSELOOP
    
  
  LEFT:
  ;SELECT MODE
  MOV AH,0
  MOV AL,06H
  MOV BH,1 
  INT 10H
  ;MOVE CURSOR
  MOV AH,2
  MOV DH,24
  MOV DL,78
  MOV BH,0
  INT 10H
 

  ;BACKGROUND COLOR
  MOV AH,0BH
  MOV BH,00H
  MOV BL,0
  INT 10H 
  ;DRAW BOARD
  MOV AH,0CH
  MOV AL,1
  MOV CX,150
  MOV DX,40
  L1:
  INT 10H
  INC CX
  CMP CX,500
  JLE L1
  L2:
  INT 10H
  INC DX
  CMP DX,160
  JLE L2
  MOV CX,150
  MOV DX,40
  L3:
  INT 10H
  INC DX
  CMP DX,160
  JLE L3
  L4:
  INT 10H
  INC CX
  CMP CX,500
  JLE L4
  
  MOV CX,265
  MOV DX,40
  L5:
  INT 10H
  INC DX
  CMP DX,160
  JLE L5
  MOV CX,375
  MOV DX,40
  L6:
  INT 10H
  INC DX
  CMP DX,160
  JLE L6
  
  MOV CX,150
  MOV DX,80
  L7:
  INT 10H
  INC CX
  CMP CX,500
  JLE L7
  
  MOV CX,150
  MOV DX,120
  L8:
  INT 10H
  INC CX
  CMP CX,500
  JLE L8
  
  MOV CX,150
  MOV DX,160
  L9:
  INT 10H
  INC CX
  CMP CX,500
  JLE L9

 


  MOUSE_LOOP:
  MOV AX,1
  INT 33H
  MOV AX,3
  INT 33H
  CMP BX,1
  JNE MOUSE_LOOP
  MOV AX,2
  INT 33H
 
 
  CMP CX,150
  JL MOUSE_LOOP 
  CMP CX,265
  JL D1
  JG R1 
  
  D1:
  CMP DX,40
  JL MOUSE_LOOP
  CMP DX,80
  JG N1
  JMP C1
  
  N1:
  CMP DX,120
  JG N2
  JMP C4
  
  N2:
  CMP DX,160
  JG MOUSE_LOOP
  JMP C7
  
  
  R1:
  CMP CX,375
  JL D2
  JG R2
  
  D2:
  CMP DX,40
  JL MOUSE_LOOP
  CMP DX,80
  JG N3
  JMP C2
  
  N3:
  CMP DX,120
  JG N4
  JMP C5
  
  N4:
  CMP DX,160
  JG MOUSE_LOOP
  JMP C8
  
  
  R2:
  CMP CX,500
  JL D3
  JG MOUSE_LOOP
  
  D3:
  CMP DX,40
  JL MOUSE_LOOP
  CMP DX,80
  JG N5
  JMP C3
  
  N5:
  CMP DX,120
  JG N6
  JMP C6
  
  N6:
  JMP C9

  
  
  
  
  
  C1:
 
  CMP CHECK,0
  JNE ENDC1
  CMP VALUE,0
  JE PLAYER11;player 1,1st turn
  JNE PLAYER21;player 2,1st turn
  PLAYER11:
  MOV AH,2
  MOV DH,7
  MOV DL,25
  INT 10H
  MOV AH,2
  MOV DL,88
  INT 21H
  INC VALUE
  INC CHECK
  JMP WIN_LOSS_TIE
  JMP MOUSE_LOOP
  
  
  PLAYER21:
  MOV AH,2
  MOV DH,7
  MOV DL,25
  INT 10H
  MOV AH,2
  MOV DL,79
  INT 21H
  ADD CHECK,2
  DEC VALUE
  JMP WIN_LOSS_TIE
  ENDC1:
  JMP MOUSE_LOOP
  
  
  C4:
  CMP CHECK+3,0
  JNE ENDC4
  ; INC CHECK+3
  CMP VALUE,0
  JE PLAYER14
  JNE PLAYER24
  PLAYER14:
  MOV AH,2
  MOV DH,12
  MOV DL,25
  INT 10H
  MOV AH,2
  MOV DL,88
  INT 21H
  INC VALUE
  INC CHECK+3
  JMP WIN_LOSS_TIE
  JMP MOUSE_LOOP
  
  
  PLAYER24:
  MOV AH,2
  MOV DL,25
  MOV DH,12
  INT 10H
  MOV AH,2
  MOV DL,79
  INT 21H
  DEC VALUE
  ADD CHECK+3,2
  JMP WIN_LOSS_TIE
  ENDC4:
  JMP MOUSE_LOOP
  
  C7:
  CMP CHECK+6,0
  JNE ENDC7
  ; INC CHECK+6
  
  CMP VALUE,0
  JE PLAYER17
  JNE PLAYER27
  
  PLAYER17:
  MOV AH,2
  MOV DH,17
  MOV DL,25
  INT 10H
  MOV AH,2
  MOV DL,88
  INT 21H
  INC VALUE
  INC CHECK+6
  JMP WIN_LOSS_TIE
  JMP MOUSE_LOOP
  
  
  PLAYER27:
  MOV AH,2
  MOV DL,25
  MOV DH,17
  INT 10H
  MOV AH,2
  MOV DL,79
  INT 21H
  ADD CHECK+6,2
  DEC VALUE
  JMP WIN_LOSS_TIE
  ENDC7:
  JMP MOUSE_LOOP
  
  
  C2:
  CMP CHECK+1,0
  JNE ENDC2
  ;INC CHECK+1
  
  CMP VALUE,0
  JE PLAYER12
  JNE PLAYER22
  PLAYER12:
  MOV AH,2
  MOV DH,7
  MOV DL,40
  INT 10H
  MOV AH,2
  MOV DL,88
  INT 21H
  INC VALUE
  INC CHECK+1
  JMP WIN_LOSS_TIE
  JMP MOUSE_LOOP
  
  
  PLAYER22:
  MOV AH,2
  MOV DL,40
  MOV DH,7
  INT 10H
  MOV AH,2
  MOV DL,79
  INT 21H
  DEC VALUE
  ADD CHECK+1,2
  JMP WIN_LOSS_TIE
  ENDC2:
  JMP MOUSE_LOOP
  
  
  
  C3:
  CMP CHECK+2,0
  JNE ENDC3
  ; INC CHECK+2
  
  CMP VALUE,0
  JE PLAYER13
  JNE PLAYER23
  PLAYER13:
  MOV AH,2
  MOV DH,7
  MOV DL,54
  INT 10H
  MOV AH,2
  MOV DL,88
  INT 21H
  INC VALUE
  INC CHECK+2
  JMP WIN_LOSS_TIE
  JMP MOUSE_LOOP
  
  
  PLAYER23:
  MOV AH,2
  MOV DL,54
  MOV DH,7
  INT 10H
  MOV AH,2
  MOV DL,79
  INT 21H
  DEC VALUE
  ADD CHECK+2,2
  JMP WIN_LOSS_TIE
  ENDC3:
  JMP MOUSE_LOOP
    
  
  C5:
  CMP CHECK+4,0
  JNE ENDC5 
  CMP VALUE,0
  JE PLAYER15
  JNE PLAYER25
  PLAYER15:
  MOV AH,2
  MOV DH,12
  MOV DL,40
  INT 10H
  MOV AH,2
  MOV DL,88
  INT 21H
  INC VALUE
  INC CHECK+4
  JMP WIN_LOSS_TIE
  JMP MOUSE_LOOP
  
  
  PLAYER25:
  MOV AH,2
  MOV DL,40
  MOV DH,12
  INT 10H
  MOV AH,2
  MOV DL,79
  INT 21H
  DEC VALUE
  ADD CHECK+4,2
  JMP WIN_LOSS_TIE
  ENDC5:
  JMP MOUSE_LOOP
  
  
  
  
  C6:
  CMP CHECK+5,0
  JNE ENDC6
  CMP VALUE,0
  JE PLAYER16
  JNE PLAYER26
  PLAYER16:
  MOV AH,2
  MOV DH,12
  MOV DL,54
  INT 10H
  MOV AH,2
  MOV DL,88
  INT 21H
  INC VALUE
  INC CHECK+5
  JMP WIN_LOSS_TIE
  JMP MOUSE_LOOP
  
  
  PLAYER26:
  MOV AH,2
  MOV DL,54
  MOV DH,12
  INT 10H
  MOV AH,2
  MOV DL,79
  INT 21H
  DEC VALUE
  ADD CHECK+5,2
  JMP WIN_LOSS_TIE
  ENDC6:
  JMP MOUSE_LOOP
  
  
  C8:  
  CMP CHECK+7,0
  JNE ENDC8
  CMP VALUE,0
  JE PLAYER18
  JNE PLAYER28
  PLAYER18:
  MOV AH,2
  MOV DH,17
  MOV DL,40
  INT 10H
  MOV AH,2
  MOV DL,88
  INT 21H
  INC VALUE
  INC CHECK+7
  JMP WIN_LOSS_TIE
  JMP MOUSE_LOOP
  
  
  PLAYER28:
  MOV AH,2
  MOV DL,40
  MOV DH,17
  INT 10H
  MOV AH,2
  MOV DL,79
  INT 21H
  DEC VALUE
  ADD CHECK+7,2
  JMP WIN_LOSS_TIE
  ENDC8:
  JMP MOUSE_LOOP
  
      
  C9: 
  CMP CHECK+8,0
  JNE ENDC9
  CMP VALUE,0
  JE PLAYER19
  JNE PLAYER29
  PLAYER19:
  MOV AH,2
  MOV DH,17
  MOV DL,54
  INT 10H
  MOV AH,2
  MOV DL,88
  INT 21H
  INC VALUE
  INC CHECK+8
  JMP WIN_LOSS_TIE
  JMP MOUSE_LOOP
   
  PLAYER29:
  MOV AH,2
  MOV DL,54
  MOV DH,17
  INT 10H
  MOV AH,2
  MOV DL,79
  INT 21H
  DEC VALUE
  ADD CHECK+8,2
  JMP WIN_LOSS_TIE
  ENDC9:
  JMP MOUSE_LOOP
  
  WIN_LOSS_TIE:
  CMP CHECK,1
  JNE LOOP1
  CMP CHECK+1,1
  JNE LOOP1
  CMP CHECK+2,1
  JNE LOOP1
  MOV AH,0CH
  MOV AL,1
  MOV CX,120
  MOV DX,60
  CROSS1:
  INT 10H
  INC CX
  CMP CX,530
  JLE CROSS1
  JMP PLAYER1_WINS
  LOOP1:
  CMP CHECK+3,1
  JNE LOOP2
  CMP CHECK+4,1
  JNE LOOP2
  CMP CHECK+5,1
  JNE LOOP2 
  MOV AH,0CH
  MOV AL,1
  MOV CX,120
  MOV DX,100
  CROSS2:
  INT 10H
  INC CX
  CMP CX,530
  JLE CROSS2  
  JMP PLAYER1_WINS
  LOOP2:
  CMP CHECK+6,1
  JNE LOOP3
  CMP CHECK+7,1
  JNE LOOP3
  CMP CHECK+8,1
  JNE LOOP3
  MOV AH,0CH
  MOV AL,1
  MOV CX,120
  MOV DX,140
  CROSS3:
  INT 10H
  INC CX
  CMP CX,530
  JLE CROSS3  
  JMP PLAYER1_WINS
  LOOP3:
  CMP CHECK,1
  JNE LOOP4
  CMP CHECK+4,1
  JNE LOOP4
  CMP CHECK+8,1
  JNE LOOP4
  MOV AH,0CH
  MOV AL,1
  MOV CX,100
  MOV DX,25
  CROSS4:
  INT 10H
  ADD CX,3
  INC DX
  CMP CX,520
  JLE CROSS4
  CMP DX,50
  JLE CROSS4 
  JMP PLAYER1_WINS
  
  LOOP4:
  CMP CHECK+2,1
  JNE LOOP5
  CMP CHECK+4,1
  JNE LOOP5
  CMP CHECK+6,1
  JNE LOOP5
  MOV AH,0CH
  MOV AL,1
  MOV CX,530
  MOV DX,25
  CROSS5:
  INT 10H
  SUB CX,3
  INC DX
  CMP CX,100
  JGE CROSS5
  CMP DX,50
  JLE CROSS5 
  JMP PLAYER1_WINS
  LOOP5:
  CMP CHECK,1
  JNE LOOP6
  CMP CHECK+3,1
  JNE LOOP6
  CMP CHECK+6,1
  JNE LOOP6
  MOV AH,0CH
  MOV AL,1
  MOV CX,200
  MOV DX,25
  CROSS6:
  INT 10H
  INC DX
  CMP DX,175
  JLE CROSS6 
  JMP PLAYER1_WINS
  
  LOOP6:
  CMP CHECK+1,1
  JNE LOOP7
  CMP CHECK+4,1
  JNE LOOP7
  CMP CHECK+7,1
  JNE LOOP7
  MOV AH,0CH
  MOV AL,1
  MOV CX,326
  MOV DX,24
  CROSS7:
  INT 10H
  INC DX
  CMP DX,175
  JLE CROSS7 
  JMP PLAYER1_WINS
  
  LOOP7:
  CMP CHECK+2,1
  JNE LOOP8
  CMP CHECK+5,1
  JNE LOOP8
  CMP CHECK+8,1
  JNE LOOP8
  MOV AH,0CH
  MOV AL,1
  MOV CX,435
  MOV DX,25
  CROSS8:
  INT 10H
  INC DX
  CMP DX,175
  JLE CROSS8   
  JMP PLAYER1_WINS
  LOOP8:
  CMP CHECK,2
  JNE LOOP9
  CMP CHECK+1,2
  JNE LOOP9
  CMP CHECK+2,2
  JNE LOOP9
  MOV AH,0CH
  MOV AL,1
  MOV CX,120
  MOV DX,60
  CROSS9:
  INT 10H
  INC CX
  CMP CX,530
  JLE CROSS9 
  JMP PLAYER2_WINS
  
  LOOP9:
  
  CMP CHECK+3,2
  JNE LOOP10
  CMP CHECK+4,2
  JNE LOOP10
  CMP CHECK+5,2
  JNE LOOP10
  MOV AH,0CH
  MOV AL,1
  MOV CX,120
  MOV DX,100
  CROSS10:
  INT 10H
  INC CX
  CMP CX,530
  JLE CROSS10
  JMP PLAYER2_WINS
  
  LOOP10:
  CMP CHECK+6,2
  JNE LOOP11
  CMP CHECK+7,2
  JNE LOOP11
  CMP CHECK+8,2
  JNE LOOP11
  MOV AH,0CH
  MOV AL,1
  MOV CX,120
  MOV DX,140
  CROSS11:
  INT 10H
  INC CX
  CMP CX,530
  JLE CROSS11
  JMP PLAYER2_WINS
  
  LOOP11:
  
  CMP CHECK,2
  JNE LOOP12
  CMP CHECK+4,2
  JNE LOOP12
  CMP CHECK+8,2
  JNE LOOP12
  
  MOV AH,0CH
  MOV AL,1
  MOV CX,100
  MOV DX,25
  CROSS12:
  INT 10H
  ADD CX,3
  INC DX
  CMP CX,520
  JLE CROSS12
  CMP DX,50
  JLE CROSS12  
  JMP PLAYER2_WINS
  
  LOOP12:
  CMP CHECK+2,2
  JNE LOOP13
  CMP CHECK+4,2
  JNE LOOP13
  CMP CHECK+6,2
  JNE LOOP13
  
  MOV AH,0CH
  MOV AL,1
  MOV CX,530
  MOV DX,25
  CROSS13:
  INT 10H
  SUB CX,3
  INC DX
  CMP CX,100
  JGE CROSS13
  CMP DX,50
  JLE CROSS13
  JMP PLAYER2_WINS
  
  LOOP13:
  CMP CHECK,2
  JNE LOOP14
  CMP CHECK+3,2
  JNE LOOP14
  CMP CHECK+6,2
  JNE LOOP14
  
  MOV AH,0CH
  MOV AL,1
  MOV CX,200
  MOV DX,25
  CROSS14:
  INT 10H
  INC DX
  CMP DX,175
  JLE CROSS14
  JMP PLAYER2_WINS
  
  LOOP14:
  CMP CHECK+1,2
  JNE LOOP15
  CMP CHECK+4,2
  JNE LOOP15
  CMP CHECK+7,2
  JNE LOOP15
  MOV AH,0CH
  MOV AL,1
  MOV CX,326
  MOV DX,24
  CROSS15:
  INT 10H
  INC DX
  CMP DX,175
  JLE CROSS15  
  JMP PLAYER2_WINS
  
  LOOP15:
  CMP CHECK+2,2
  JNE LOOP16
  CMP CHECK+5,2
  JNE LOOP16
  CMP CHECK+8,2
  JNE LOOP16
  MOV AH,0CH
  MOV AL,1
  MOV CX,435
  MOV DX,25
  CROSS16:
  INT 10H
  INC DX
  CMP DX,175
  JLE CROSS16   
  JMP PLAYER2_WINS
  
  LOOP16:
  JMP TIE_CHECK
  
  PLAYER1_WINS:
  MOV AH,13H 
  MOV BP,OFFSET PLAYER_1
  MOV AL,1
  MOV BL,1
  MOV BH,1
  MOV CX,16
  MOV DL,35
  MOV DH,1
  INT 10H 
  JMP PLAY_AGAIN1
  PLAYER2_WINS:
  MOV AH,13H 
  MOV  BP,OFFSET PLAYER_2
  MOV AL,1
  MOV BL,1
  MOV BH,1
  MOV CX,16
  MOV DL,35
  MOV DH,1
  INT 10H 
  JMP PLAY_AGAIN1
  
  TIE_CHECK:
  CMP CHECK,0
  JE ENDTIE
  CMP CHECK+1,0
  JE ENDTIE
  CMP CHECK+2,0
  JE ENDTIE
  CMP CHECK+3,0
  JE ENDTIE
  CMP CHECK+4,0
  JE ENDTIE
  CMP CHECK+5,0
  JE ENDTIE
  CMP CHECK+6,0
  JE ENDTIE
  CMP CHECK+7,0
  JE ENDTIE
  CMP CHECK+8,0
  JE ENDTIE
  TIE:
  MOV AH,13H
  MOV BP,OFFSET DRAW
  MOV AL,1
  MOV BL,1
  MOV CX,11
  MOV DL,35
  MOV DH,2
  INT 10H
  JMP PLAY_AGAIN1
  
  ENDTIE:
  JMP MOUSE_LOOP
   
  PLAY_AGAIN1:
  MOV AH,13H
  MOV BP,OFFSET PLAY_AGAIN
  MOV BL,1
  MOV CX,11
  MOV DL,3
  MOV DH,8
  INT 10H
  MOV BP,OFFSET YES
  MOV BL,1
  MOV CX,3
  MOV DL,4
  MOV DH,12
  INT 10H
  MOV BP,OFFSET NO
  MOV CX,2
  MOV DL,4
  MOV DH,16
  INT 10H
  MOV AH,0CH
  MOV AL,1
  MOV CX,28
  MOV DX,90
  RP:
  INT 10H
  INC CX
  CMP CX,48
  JLE RP
  MOV CX,28
  MOV DX,120
  PR:
  INT 10H
  INC CX
  CMP CX,48
  JLE PR
  
  YES_OR_NO:
  MOV AX,1
  INT 33H
  MOV AX,3
  INT 33H
  CMP BX,1
  JNE YES_OR_NO
  MOV AX,2
  INT 33H
  CMP CX,28
  JL YES_OR_NO
  CMP CX,48
  JG YES_OR_NO
  CMP DX,90
  JL YES_OR_NO
  CMP DX,115
  JG CHECK_NO
  JMP MAIN
  CHECK_NO:
  CMP DX,130
  JL EXIT 
  
  
  
  EXIT: 
  
  MOV AH,2
  MOV DH,24
  MOV DL,78
  MOV BH,0
  INT 10H
  
  MOV AH,4CH
  INT 21H
 
  MAIN ENDP
  END MAIN
  
